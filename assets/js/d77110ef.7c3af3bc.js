"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[94],{7065:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var t=a(5893),s=a(1151);const i={sidebar_position:4},o="V\xed d\u1ee5 liquibase - database version control",l={id:"java/liquibase-set-up",title:"V\xed d\u1ee5 liquibase - database version control",description:"T\xf3m t\u1eaft",source:"@site/docs/java/liquibase-set-up.md",sourceDirName:"java",slug:"/java/liquibase-set-up",permalink:"/docs/java/liquibase-set-up",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Integration test v\u1edbi springboot v\xe0 test-container",permalink:"/docs/java/integration-test-with-springboot-and-test-container"},next:{title:"Kafka",permalink:"/docs/kafka/kafka-basic"}},r={},c=[{value:"T\xf3m t\u1eaft",id:"t\xf3m-t\u1eaft",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Code example",id:"code-example",level:2},{value:"Gi\u1ea3i th\xedch chi ti\u1ebft",id:"gi\u1ea3i-th\xedch-chi-ti\u1ebft",level:2},{value:"<strong>Database Changelog and Database Changelog Lock</strong>",id:"database-changelog-and-database-changelog-lock",level:3},{value:"C\xe2u h\u1ecfi t\u1ef1 tr\u1ea3 l\u1eddi",id:"c\xe2u-h\u1ecfi-t\u1ef1-tr\u1ea3-l\u1eddi",level:2},{value:"References",id:"references",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"v\xed-d\u1ee5-liquibase---database-version-control",children:"V\xed d\u1ee5 liquibase - database version control"}),"\n",(0,t.jsx)(n.h2,{id:"t\xf3m-t\u1eaft",children:"T\xf3m t\u1eaft"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ch\xfang ta s\u1ebd t\u1ea1o 1 project springboot v\u1edbi database postgresql, s\u1eed d\u1ee5ng liquibase \u0111\u1ec3 qu\u1ea3n l\xfd version c\u1ee7a database."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u0110\u1ecdc references"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"code-example",children:"Code example"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"file build.gradle"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"dependencies {\n    implementation 'org.springframework.boot:spring-boot-starter'\n    implementation 'org.liquibase:liquibase-core'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'org.postgresql:postgresql'\n\n    compileOnly 'org.projectlombok:lombok'\n\n    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'\n    annotationProcessor 'org.projectlombok:lombok'\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"file application.yml"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'spring:\n  liquibase:\n    url: jdbc:postgresql://localhost:5432/${DATABASE_NAME:hoang-test-liquibase}\n    user: postgres\n    password: postgres\n    change-log: "classpath:db/changelog/changelog-master.xml"\n  datasource:\n    url: jdbc:postgresql://localhost:5432/${DATABASE_NAME:hoang-test-liquibase}\n    username: postgres\n    password: postgres\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"file resouces/db/changelog/changelog-master.xml"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<databaseChangeLog\n        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"\n        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.7.xsd"\n>\n    <changeSet author="hoang.tran" id="init_database">\n        <sql>\n            CREATE TABLE IF NOT EXISTS hoang_s_table\n            (\n                id                         BIGSERIAL PRIMARY KEY,\n                transaction_id             VARCHAR(50) NOT NULL\n                );\n        </sql>\n    </changeSet>\n\n    <changeSet author="huy.loc" id="extend_card_number_length">\n        <sql>\n            ALTER TABLE hoang_s_table\n            ADD name VARCHAR(20);\n        </sql>\n    </changeSet>\n</databaseChangeLog>\n'})}),"\n",(0,t.jsx)(n.h2,{id:"gi\u1ea3i-th\xedch-chi-ti\u1ebft",children:"Gi\u1ea3i th\xedch chi ti\u1ebft"}),"\n",(0,t.jsx)(n.h3,{id:"database-changelog-and-database-changelog-lock",children:(0,t.jsx)(n.strong,{children:"Database Changelog and Database Changelog Lock"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Khi b\u1ea1n t\u1ea1o thay \u0111\u1ed5i,Liquibase s\u1ebd t\u1ea1o 2 b\u1ea3ng Database Changelog, Database Changelog Lock","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The DATABASECHANGELOG table tracks deployed changes so that you have a record. Liquibase compares the changesets in the changelog file with the DATABASECHANGELOG tracking table and deploys only new changesets."}),"\n",(0,t.jsx)(n.li,{children:"DATABASECHANGELOGLOCK prevents multiple instances of Liquibase from updating the database at the same time. The table manages access to the DATABASECHANGELOG table during deployment and ensures only one instance of Liquibase is updating the database."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"c\xe2u-h\u1ecfi-t\u1ef1-tr\u1ea3-l\u1eddi",children:"C\xe2u h\u1ecfi t\u1ef1 tr\u1ea3 l\u1eddi"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Th\xeam 1 changSet m\u1edbi v\xe0 ch\u1ea1y th\u1eed."}),"\n",(0,t.jsx)(n.li,{children:"Ho\u1eb7c Thay \u0111\u1ed5i changeSet c\u0169 v\xe0 ch\u1ea1y th\u1eed, c\xf3 g\xec x\u1ea3y ra ?"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.liquibase.com/home.html",children:"https://docs.liquibase.com/home.html"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},1151:(e,n,a)=>{a.d(n,{Z:()=>l,a:()=>o});var t=a(7294);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);